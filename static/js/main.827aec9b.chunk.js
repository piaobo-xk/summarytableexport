(this.webpackJsonpsummarytableexport=this.webpackJsonpsummarytableexport||[]).push([[0],{111:function(e,t){},165:function(e,t,a){e.exports=a(317)},170:function(e,t,a){},171:function(e,t,a){},176:function(e,t){},177:function(e,t){},178:function(e,t,a){},317:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(23),l=a.n(r),c=(a(170),a(171),a(127)),i=a(128),d=a(162),f=a(158),s=a(322),u=a(323),g=a(324),m=a(321),b=a(42),h=a(320),p=a(325),y=a(78),x=a.n(y),w=a(95),k=a(326),v=a(327),C=a(328),E=(a(178),a(159));function j(){var e=new Date("2020/09/13 22:06:00").getTime(),t=Object(n.useState)((new Date).getTime()),a=Object(E.a)(t,2),r=a[0],l=a[1],c=r-e,i=Math.floor(c/864e5),d=Math.floor(c%864e5/36e5),f=Math.floor(c%36e5/6e4),s=Math.floor(c%6e4/1e3),u="".concat(i,"\u5929").concat(d,"\u5c0f\u65f6").concat(f,"\u5206\u949f").concat(s,"\u79d2");return setInterval((function(){l((new Date).getTime())}),1e3),o.a.createElement("div",{style:{textAlign:"right",color:"#fff",fontSize:"3px"}},u)}var I=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={dataSource:[],taizhang:[]},n}return Object(i.a)(a,[{key:"beforeUpload",value:function(e,t){var a=this;this.setState({loading:!0});var n=this.state.taizhang,o=void 0===n?[]:n,r={};console.log(e,t);var l=new FileReader;return l.onload=function(e){try{!function(){var t=e.target.result,n=x.a.read(t,{type:"binary"}),l=[];console.log(n.Sheets);var c=n.Sheets["\u7ed3\u7b97\u5ba1\u8ba1\u62a5\u544a\u5173\u8054\u9879\u76ee\u8868"];c&&(l=l.concat(x.a.utils.sheet_to_json(c)));var i=l[0];for(var d in i)switch(i[d]){case"\u5e8f\u53f7":r.num=d;break;case"\u5730\u5e02":r.city=d;break;case"\u9879\u76ee\u540d\u79f0":r.project_name=d;break;case"\u9879\u76ee\u7f16\u7801":r.project_num=d;break;case"\u9879\u76ee\u7c7b\u578b":r.project_type=d;break;case"\u5efa\u8bbe\u65b9\u5f0f":r.build_method=d}console.log(r);for(var f=[],s=function(e){var t=o.find((function(t){return t["\u9879\u76ee\u7f16\u7801"]===l[e][r.project_num]}))||{};f.push({num:l[e][r.num],city:l[e][r.city],project_name:l[e][r.project_name],project_num:l[e][r.project_num],project_type:l[e][r.project_type],build_method:l[e][r.build_method],"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0":t["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0"],"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a":t["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a"],"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0":t["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0"],"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a":t["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a"],"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0":t["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0"],"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a":t["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a"],"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0":t["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0"],"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a":t["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a"],"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50":t["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50"],"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5":t["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5"],"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0":t["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0"],"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a":t["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a"],total0:Object(w.sum)([t["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0"],t["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0"],t["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0"],t["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0"],t["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50"],t["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0"]]),total:Object(w.sum)([t["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a"],t["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a"],t["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a"],t["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a"],t["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5"],t["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a"]])})},u=1;u<l.length;u++)s(u);a.setState({dataSource:f,loading:!1}),console.log("data",l)}()}catch(e){s.a.warning({message:"\u9047\u5230\u9884\u6599\u5916\u7684\u9519\u8bef\uff01"}),console.log(e),a.setState({loading:!1})}},l.readAsBinaryString(e),!1}},{key:"beforeUpload2",value:function(e,t){var a=this;this.setState({loading2:!0});var n={},o=new FileReader;return o.onload=function(e){try{var t=e.target.result,o=x.a.read(t,{type:"binary"}),r=[],l=o.Sheets.sheet1;l&&(r=r.concat(x.a.utils.sheet_to_json(l)));var c=r[0];for(var i in console.log(c),c)switch(c[i]){case"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0":n["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0"]=i;break;case"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a":n["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a"]=i;break;case"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0":n["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0"]=i;break;case"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a":n["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a"]=i;break;case"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0":n["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0"]=i;break;case"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a":n["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a"]=i;break;case"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0":n["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0"]=i;break;case"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a":n["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a"]=i;break;case"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50":n["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50"]=i;break;case"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5":n["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5"]=i;break;case"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0":n["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0"]=i;break;case"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a":n["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a"]=i}for(var d=[],f=2;f<r.length;f++)d.push({"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0":r[f][n["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0"]],"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a":r[f][n["\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a"]],"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0":r[f][n["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0"]],"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a":r[f][n["\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a"]],"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0":r[f][n["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0"]],"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a":r[f][n["\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a"]],"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0":r[f][n["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0"]],"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a":r[f][n["\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a"]],"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50":r[f][n["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50"]],"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5":r[f][n["\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5"]],"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0":r[f][n["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0"]],"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a":r[f][n["\u5854\u6845\u65bd\u5de5\u4e13\u4e1a"]],"\u9879\u76ee\u7f16\u7801":r[f]["\u9879\u76ee\u7f16\u53f7"]});a.setState({taizhang:d,loading2:!1})}catch(e){a.setState({loading2:!1}),s.a.warning({message:"\u9047\u5230\u9884\u6599\u5916\u7684\u9519\u8bef\uff01"}),console.log(e)}},o.readAsBinaryString(e),!1}},{key:"exportToExcel",value:function(){this.setState({loading3:!0});var e=document.querySelector("#export-table table");e.border="1";var t=e.outerHTML,a=new Blob([t],{type:"application/vnd.ms-excel;charset=utf-8"}),n=new Blob([String.fromCharCode(65279),a],{type:a.type}),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download="\u6c47\u603b\u8868",o.click(),URL.revokeObjectURL(o.href),o.remove(),e.border="0",this.setState({loading3:!1})}},{key:"render",value:function(){var e=this.state,t=e.dataSource,a=void 0===t?[]:t,n=e.taizhang,r=void 0===n?[]:n,l=e.loading2,c=e.loading,i=e.loading3,d=[{title:"\u5e8f\u53f7",dataIndex:"num",render:function(e,t,a){return a+1},width:80,align:"center"},{title:"\u6240\u5c5e\u5730",dataIndex:"city",width:120,align:"center"},{title:"\u9879\u76ee\u540d\u79f0",dataIndex:"project_name",width:400,align:"center"},{title:"\u9879\u76ee\u7f16\u53f7",dataIndex:"project_num",width:200,align:"center"},{title:"\u9879\u76ee\u7c7b\u578b",dataIndex:"project_type",width:200,align:"center"},{title:"\u5efa\u8bbe\u65b9\u5f0f",dataIndex:"build_method",width:100,align:"center"},{title:"\u9001\u5ba1\u91d1\u989d\uff08\u5143\uff09",key:"\u9001\u5ba1\u91d1\u989d",width:700,align:"center",children:[{title:"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a0",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a0",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a0",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a0",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5",dataIndex:"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de50",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a0",width:100,onCell:function(e){return{style:{backgroundColor:"#e3b4b8",color:"#ffffff"}}},align:"center"},{title:"\u5408\u8ba1",dataIndex:"total0",width:100,onCell:function(e){return{style:{backgroundColor:"#eb261a",color:"#ffffff"}}},render:function(e){return e.toFixed(2)},align:"center"}]},{title:"\u5ba1\u5b9a\u91d1\u989d\uff08\u5143\uff09",key:"\u5ba1\u5b9a\u91d1\u989d",width:700,align:"center",children:[{title:"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5854\u57fa\u65bd\u5de5\u4e13\u4e1a",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u673a\u623f\uff08\u67dc\uff09\u571f\u5efa\u65bd\u5de5\u4e13\u4e1a",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u52a8\u529b\u914d\u5957\u65bd\u5de5\u4e13\u4e1a",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5916\u7535\u5f15\u5165\u65bd\u5de5\u4e13\u4e1a",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5",dataIndex:"\u5ba4\u5185\u5206\u5e03\u7cfb\u7edf\u4e13\u4e1a\u65bd\u5de5",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a",dataIndex:"\u5854\u6845\u65bd\u5de5\u4e13\u4e1a",width:100,onCell:function(e){return{style:{backgroundColor:"#b2cf87",color:"#ffffff"}}},align:"center"},{title:"\u5408\u8ba1",dataIndex:"total",width:100,onCell:function(e){return{style:{backgroundColor:"#eb261a",color:"#ffffff"}}},render:function(e){return e.toFixed(2)},align:"center"}]},{title:"\u5ba1\u589e\uff08+\uff09\u5ba1\u51cf\uff08-\uff09",dataIndex:"total-total0",width:100,render:function(e,t){return(t.total-t.total0).toFixed(2)},align:"center"}];return o.a.createElement(o.a.Fragment,null,o.a.createElement(j,null),o.a.createElement(u.a,{gutter:48,style:{margin:"20px 0"}},o.a.createElement(g.a,{md:8,sm:24,xs:24,style:{marginBottom:"10px"}},o.a.createElement("label",{htmlFor:"upload2",style:{color:"#fff"}},"\u7ed3\u7b97\u53f0\u8d26\uff1a"),o.a.createElement(m.a,{accept:".xls, .xlsx",name:"upload2",showUploadList:!0,action:null,beforeUpload:this.beforeUpload2.bind(this)},o.a.createElement(b.a,{icon:o.a.createElement(k.a,null),loading:l,ghost:!0},"\u5bfc\u5165\u7ed3\u7b97\u53f0\u8d26"))),o.a.createElement(g.a,{md:8,sm:24,xs:24,style:{marginBottom:"10px"}},o.a.createElement("label",{htmlFor:"upload",style:{color:"#fff"}},"PROJECTINFO\uff1a"),o.a.createElement(m.a,{accept:".xls, .xlsx",name:"upload",showUploadList:!0,action:null,beforeUpload:this.beforeUpload.bind(this),disabled:0===r.length},o.a.createElement(b.a,{icon:o.a.createElement(k.a,null),loading:c,disabled:0===r.length,ghost:!0},"\u5bfc\u5165PROJECTINFO"))),o.a.createElement(g.a,{md:8,sm:24,xs:24,style:{marginBottom:"10px"}},o.a.createElement(b.a,{type:"primary",icon:o.a.createElement(v.a,null),onClick:this.exportToExcel.bind(this),disabled:0===a.length,loading:i},"\u5bfc\u51fa"))),o.a.createElement(h.a,{bordered:!0,columns:d,dataSource:a,pagination:!1,id:"export-table",scroll:{x:100+Object(w.sum)(d.map((function(e){return e.width})))},loading:c,rowKey:"project_num"}),o.a.createElement("p",{style:{color:"#ad9d9d",fontSize:"3px",padding:"6em 0",textAlign:"left"}},"\u53ef\u80fd\u4f60\u518d\u4e5f\u4e0d\u4f1a\u6253\u5f00\u8fd9\u4e2a\u9875\u9762\u4e86\uff0c\u53ef\u80fd\u4e5f\u662f\u6211\u6700\u540e\u4e3a\u4f60\u505a\u7684\u4e00\u4ef6\u4e8b\u3002"),o.a.createElement("p",{style:{color:"#ad9d9d",textAlign:"left"}},"\u5e0c\u671b\u4f60\u6bcf\u5929\u5e78\u798f\u30022020-09-20 21:22"),o.a.createElement(p.a,null,o.a.createElement("div",{className:"backtop-div"},o.a.createElement(C.a,{style:{fontSize:"30px"}}))))}}]),a}(n.Component);var S=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("div",{style:{margin:"0 auto"}},o.a.createElement(I,{key:"myapp"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[165,1,2]]]);
//# sourceMappingURL=main.827aec9b.chunk.js.map